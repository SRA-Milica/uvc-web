import{d as Y,E as _,O as Z,j as B,c as v,M as V,N as E,f as ee,S as te,ae as se,a as l,b as e,Q as g,p as w,F as h,r as y,w as ne,C as le,s as f,u as o,a6 as S,J as ce,H as ie,a7 as oe,a0 as ae,o as c,t as i,a1 as k,a2 as d,n as re,l as de,P as ue,a8 as _e,a9 as pe,af as ve}from"./index-75810c09.js";const fe={class:"grid grid-cols-12 border-2 h-full"},xe={class:"col-span-12 md:col-span-3 bg-base-100 px-5 py-10 h-full border-r-2"},he={class:"sidebar-menu"},ye=e("span",{class:"mdi mdi-inbox text-2xl mr-4"},null,-1),me=e("span",{class:"mdi mdi-check-all text-2xl mr-4"},null,-1),ge=e("span",{class:"mdi mdi-calendar-clock text-2xl mr-4"},null,-1),be=e("span",{class:"mdi mdi-format-list-checks text-2xl mr-3"},null,-1),je=e("hr",{class:"mb-5"},null,-1),we={class:"flex mr-5"},ke=e("option",{value:"All"},"Categories",-1),Se=["value"],Ce={class:"col-span-12 md:col-span-9 bg-white h-full overflow-y-auto"},De={key:0,class:"flex align-center justify-between border-b px-6 py-2"},Me={class:"flex items-center gap-9"},Ne={class:"flex mr-5"},Pe=e("label",{for:"sort-dropdown",class:"text-lg mr-2"},"Sort by:",-1),Ae=e("option",{value:"desc"},"By Date Sent Descending",-1),Te=e("option",{value:"asc"},"By Date Sent Ascending",-1),$e=e("option",{value:"scheduleAsc"},"By Date Scheduled Ascending",-1),Be=e("option",{value:"scheduleDesc"},"By Date Scheduled Descending",-1),Ve=[Ae,Te,$e,Be],Ee={class:"flex items-center justify-center my-4"},Ie={"aria-label":"Pagination"},Re={class:"inline-flex items-center -space-x-px"},Ue=["disabled"],ze=e("span",{class:"mdi mdi-chevron-left"},null,-1),Fe=[ze],He=["onClick"],Oe=["disabled"],qe=e("span",{class:"mdi mdi-chevron-right"},null,-1),Je=[qe],Le={key:1,class:"message-list"},Qe={class:"overflow-x-auto sm:overflow-visible"},Ge=S('<div class="grid grid-cols-12 gap-4 py-6 bg-gray-100 font-semibold min-w-[640px] sm:min-w-full"><div class="flex items-center justify-center md:col-span-2 col-span-1 text-center"><p>Sender</p></div><div class="flex items-center justify-center md:col-span-2 col-span-1 text-center"><p>Title</p></div><div class="flex items-center justify-center col-span-2 text-center"><p>Message Preview</p></div><div class="flex items-center justify-center col-span-2 text-center"><p>Date Sent</p></div><div class="flex items-center justify-center md:col-span-2 col-span-4 text-center"><p>Scheduled Date</p></div><div class="flex items-center justify-center col-span-2 text-center"><p>Notification Status</p></div></div>',1),Ke={class:"divide-y divide-gray-200"},We=["onClick"],Xe={class:"flex items-center justify-center md:col-span-2 col-span-1 text-center"},Ye={class:"flex items-center justify-center md:col-span-2 col-span-1 text-center"},Ze={class:"flex items-center justify-center col-span-2 text-center"},et={class:"flex items-center justify-center col-span-2 text-center"},tt={class:"flex items-center justify-center md:col-span-2 col-span-4 text-center"},st={class:"flex items-center justify-center"},nt={class:"align-center"},lt={key:1},ct={key:2,class:"message-list"},it={class:"overflow-x-auto sm:overflow-visible"},ot=S('<div class="grid grid-cols-12 gap-4 py-6 bg-gray-100 font-semibold min-w-[640px] sm:min-w-full"><div class="flex items-center justify-center md:col-span-2 col-span-1 text-center"><p>Sender</p></div><div class="flex items-center justify-center md:col-span-2 col-span-1 text-center"><p>Title</p></div><div class="flex items-center justify-center col-span-2 text-center"><p>Message Preview</p></div><div class="flex items-center justify-center col-span-2 text-center"><p>Date Sent</p></div><div class="flex items-center justify-center md:col-span-2 col-span-4 text-center"><p>Scheduled Date</p></div><div class="flex items-center justify-center col-span-2 text-center"><p>Notification Status</p></div></div>',1),at={class:"divide-y divide-gray-200"},rt=["onClick"],dt={class:"flex items-center justify-center md:col-span-2 col-span-1 text-center"},ut={class:"flex items-center justify-center md:col-span-2 col-span-1 text-center"},_t={class:"flex items-center justify-center col-span-2 text-center"},pt={class:"flex items-center justify-center col-span-2 text-center"},vt={class:"flex items-center justify-center md:col-span-2 col-span-4 text-center"},ft={key:0,class:"flex items-center justify-center col-span-2 text-center"},xt=e("p",{class:"text-gray-500"},"No Notification",-1),ht=[xt],yt={key:1,class:"flex items-center justify-center col-span-2 text-center"},mt={key:3,class:"message-list"},gt=S('<div class="grid grid-cols-12 gap-4 py-6 px-6 bg-gray-100 font-semibold"><div class="flex items-center justify-center col-span-2 text-center"><p>Sender</p></div><div class="flex items-center justify-center col-span-2 text-center"><p>Title</p></div><div class="flex items-center justify-center col-span-2 text-center"><p>Message Preview</p></div><div class="flex items-center justify-center col-span-2 text-center"><p>Date Sent</p></div><div class="flex items-center justify-center col-span-2 text-center"><p>Scheduled Date</p></div><div class="flex items-center justify-center col-span-2 text-center"><p>Notification Status</p></div></div>',1),bt={class:"divide-y divide-gray-200"},jt=["onClick"],wt={class:"flex items-center justify-center col-span-2 text-center"},kt={class:"flex items-center justify-center col-span-2 text-center"},St={class:"flex items-center justify-center col-span-2 text-center"},Ct={class:"flex items-center justify-center col-span-2 text-center"},Dt={class:"flex items-center justify-center col-span-2 text-center"},Mt={key:0,class:"flex items-center justify-center col-span-2 text-center"},Nt=e("p",{class:"text-gray-500"},"No Notification",-1),Pt=[Nt],At={key:1,class:"flex items-center justify-center col-span-2 text-center"},Tt={key:4,class:"message-list"},$t=S('<div class="grid grid-cols-12 gap-4 py-6 px-6 bg-gray-100 font-semibold"><div class="col-span-9 block h-full text-inherit"><div class="grid grid-cols-12 gap-4 h-full"><div class="flex items-center justify-center col-span-2 text-center"><p>Sender</p></div><div class="flex items-center justify-center col-span-2 text-center"><p>Title</p></div><div class="flex items-center justify-center col-span-2 text-center"><p>Date Sent</p></div><div class="flex items-center justify-center col-span-4 text-center"><p>Scheduled Date</p></div><div class="flex items-center justify-center col-span-2 text-center"><p>Notification Status</p></div></div></div><div class="flex items-center justify-end col-span-3 text-center"><p>Download tempalte</p></div></div>',1),Bt={key:0},Vt={class:"border divide-y divide-gray-200"},Et={class:"grid grid-cols-12 gap-4 h-full"},It={class:"flex items-center justify-center col-span-2 text-center"},Rt={class:"flex items-center justify-center col-span-2 text-center"},Ut={class:"flex items-center justify-center col-span-2 text-center"},zt={class:"flex items-center justify-center col-span-4 text-center"},Ft={key:0,class:"flex items-center justify-center col-span-2 text-center"},Ht=e("p",{class:"text-gray-500"},"No Notification",-1),Ot=[Ht],qt={key:1,class:"flex items-center justify-center col-span-2 text-center"},Jt={class:"flex items-center justify-end col-span-3"},Lt=["onClick"],Qt={key:0,class:"text-center py-8"},Gt=e("p",{class:"text-lg text-gray-500"},"Currently no new surveys to show.",-1),Kt=[Gt],A="All",Yt=Y({__name:"SentMessages",setup(Wt){const C=_([]),I=async()=>{try{const s=V(E.DB,"mails"),n=await fetch(s);if(!n.ok)throw new Error("Network response was not ok");const r=await n.json();console.log(r),C.value=r}catch(s){console.error("Error fetching mail data:",s)}};Z(()=>{I()}),B(C,s=>{console.log("Mails data updated:",s)});const a=_("inbox"),u=_(1),D=_(5),M=v(()=>Math.ceil($.value.length/D.value)),R=()=>{u.value>1&&u.value--},U=()=>{u.value<M.value&&u.value++},z=s=>{u.value=s},F=v(()=>{const s=(u.value-1)*D.value,n=s+D.value;return $.value.slice(s,n)}),H=ce(),b=_e(),O=V(E.DB,"surveys"),q=s=>{pe(O,s)};B(()=>H.query.activeTab,s=>{typeof s=="string"?a.value=s:a.value="inbox"},{immediate:!0});const J=ee(te.auth),L=ie(),T=_({}),j=(s,n=6)=>{const r=s.split(/\s+/);return r.length<=n?s:r.slice(0,n).join(" ")+"..."},N=(s,n)=>{ve(n),L.push(`/message/${s}`)},P=_(oe()),m=_("desc"),$=v(()=>P.value.filter(s=>p.value===A||s.category===p.value).map(s=>({...s,selected:T.value[s.id]||!1})).sort((s,n)=>{switch(m.value){case"asc":return s.date_sent-n.date_sent;case"desc":return n.date_sent-s.date_sent;case"scheduleAsc":return s.schedule_date_from-n.schedule_date_from;case"scheduleDesc":return n.schedule_date_from-s.schedule_date_from;default:return 0}})),Q=v(()=>P.value.filter(s=>s.sender_id===J.id).filter(s=>p.value===A||s.category===p.value).sort((s,n)=>{switch(m.value){case"asc":return s.date_sent-n.date_sent;case"desc":return n.date_sent-s.date_sent;case"scheduleAsc":return s.schedule_date_from-n.schedule_date_from;case"scheduleDesc":return n.schedule_date_from-s.schedule_date_from;default:return 0}})),G=v(()=>{const s=new Date().getTime();return P.value.filter(n=>(p.value===A||n.category===p.value)&&n.schedule_date_from>=s).map(n=>({...n,selected:T.value[n.id]||!1})).sort((n,r)=>{switch(m.value){case"asc":return n.date_sent-r.date_sent;case"desc":return r.date_sent-n.date_sent;case"scheduleAsc":return n.schedule_date_from-r.schedule_date_from;case"scheduleDesc":return r.schedule_date_from-n.schedule_date_from;default:return 0}})}),p=_("All"),K=s=>{const n=s.target;p.value=n.value},W=v(()=>se.filter(s=>s.name!=="Survey")),X=v(()=>["inbox","sent","scheduled","category","survey"].includes(a.value));return(s,n)=>{const r=ae("router-link");return c(),l("div",fe,[e("aside",xe,[e("div",he,[e("ul",null,[e("li",null,[e("button",{onClick:n[0]||(n[0]=t=>a.value="inbox"),class:g([{"active-tab":a.value==="inbox"},"bg-base-100 flex align-center w-full text-xl text-left px-5 py-3"])},[ye,w(" All Messages ")],2)]),e("li",null,[e("button",{onClick:n[1]||(n[1]=t=>a.value="sent"),class:g([{"active-tab":a.value==="sent"},"bg-base-100 flex align-center w-full text-xl text-left px-5 py-3"])},[me,w(" Sent Messages ")],2)]),e("li",null,[e("button",{onClick:n[2]||(n[2]=t=>a.value="scheduled"),class:g([{"active-tab":a.value==="scheduled"},"bg-base-100 flex align-center w-full text-xl text-left px-5 py-3"])},[ge,w(" Scheduled Messages ")],2)]),e("li",null,[e("button",{onClick:n[3]||(n[3]=t=>a.value="survey"),class:g([{"active-tab":a.value==="survey"},"bg-base-100 flex align-center w-full text-xl text-left px-5 py-3"])},[be,w(" Surveys ")],2)]),je,e("li",null,[e("div",we,[e("select",{id:"category-dropdown",class:"select",onChange:K},[ke,(c(!0),l(h,null,y(W.value,t=>(c(),l("option",{key:t.name,value:t.name},i(t.name),9,Se))),128))],32)])])])])]),e("main",Ce,[X.value?(c(),l("div",De,[e("div",Me,[e("div",Ne,[Pe,ne(e("select",{id:"sort-dropdown","onUpdate:modelValue":n[4]||(n[4]=t=>m.value=t),class:"text-lg font-semibold"},Ve,512),[[le,m.value]])])]),e("div",Ee,[e("nav",Ie,[e("ul",Re,[e("li",null,[e("button",{onClick:R,disabled:u.value===1,class:"py-2 px-3 ml-0 leading-tight text-gray-500 bg-white rounded-l-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700"},Fe,8,Ue)]),(c(!0),l(h,null,y(M.value,t=>(c(),l("li",{key:t},[e("button",{onClick:x=>z(t),class:g([{"bg-blue-500 text-primary":t===u.value},"py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700"])},i(t),11,He)]))),128)),e("li",null,[e("button",{onClick:U,disabled:u.value===M.value,class:"py-2 px-3 leading-tight text-gray-500 bg-white rounded-r-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700"},Je,8,Oe)])])])])])):f("",!0),a.value==="inbox"?(c(),l("div",Le,[e("div",Qe,[Ge,e("ul",Ke,[(c(!0),l(h,null,y(F.value,t=>(c(),l("li",{key:t.id,class:"grid grid-cols-12 gap-4 py-6 hover:bg-gray-100 text-inherit cursor-pointer min-w-[640px] sm:min-w-full",onClick:x=>N(t.id,t)},[e("div",Xe,[e("p",null,i(o(k)(t.sender_id).name),1)]),e("div",Ye,[e("p",null,i(j(t.title)),1)]),e("div",Ze,[e("p",null,i(j(t.context)),1)]),e("div",et,[e("p",null,i(o(d)(t.date_sent)),1)]),e("div",tt,[e("p",null,i(o(d)(t.schedule_date_from))+" ～ "+i(o(d)(t.schedule_date_to)),1)]),e("div",st,[e("ul",nt,[C.value.some(x=>x.messageId===t.id)?(c(),l("li",{key:t.id}," Notified ")):(c(),l("li",lt," Pending "))])])],8,We))),128))])])])):f("",!0),a.value==="sent"?(c(),l("div",ct,[e("div",it,[ot,e("ul",at,[(c(!0),l(h,null,y(Q.value,t=>(c(),l("li",{key:t.id,class:"grid grid-cols-12 gap-4 py-6 hover:bg-gray-100 text-inherit cursor-pointer min-w-[640px] sm:min-w-full",onClick:x=>N(t.id,t)},[e("div",dt,[e("p",null,i(o(k)(t.sender_id).name),1)]),e("div",ut,[e("p",null,i(t.title),1)]),e("div",_t,[e("p",null,i(j(t.context)),1)]),e("div",pt,[e("p",null,i(o(d)(t.date_sent)),1)]),e("div",vt,[e("p",null,i(o(d)(t.schedule_date_from))+" ～ "+i(o(d)(t.schedule_date_to)),1)]),t.is_notify_mail?(c(),l("div",yt)):(c(),l("div",ft,ht))],8,rt))),128))])])])):f("",!0),a.value==="scheduled"?(c(),l("div",mt,[gt,e("ul",bt,[(c(!0),l(h,null,y(G.value,t=>(c(),l("li",{key:t.id,class:"grid grid-cols-12 gap-4 py-6 px-6 hover:bg-gray-100 text-inherit cursor-pointer",onClick:x=>N(t.id,t)},[e("div",wt,[e("p",null,i(o(k)(t.sender_id).name),1)]),e("div",kt,[e("p",null,i(t.title),1)]),e("div",St,[e("p",null,i(j(t.context)),1)]),e("div",Ct,[e("p",null,i(o(d)(t.date_sent)),1)]),e("div",Dt,[e("p",null,i(o(d)(t.schedule_date_from))+" ～ "+i(o(d)(t.schedule_date_to)),1)]),t.is_notify_mail?(c(),l("div",At)):(c(),l("div",Mt,Pt))],8,jt))),128))])])):f("",!0),a.value==="survey"?(c(),l("div",Tt,[$t,e("div",null,[o(b)&&o(b).length>0?(c(),l("div",Bt,[e("ul",Vt,[(c(!0),l(h,null,y(o(b),t=>(c(),l("li",{key:t.id,class:"grid grid-cols-12 gap-4 py-8 px-4 hover:bg-gray-100 text-inherit"},[re(r,{to:{name:"AppSurveyView",params:{id:t.id}},class:"col-span-9 block h-full text-inherit"},{default:de(()=>[e("div",Et,[e("div",It,[e("p",null,i(o(k)(t.sender_id).name),1)]),e("div",Rt,[e("p",null,i(t.title),1)]),e("div",Ut,[e("p",null,i(o(d)(t.date_sent)),1)]),e("div",zt,[e("p",null,i(o(d)(t.answer_date_from))+" ～ "+i(o(d)(t.answer_date_to)),1)]),t.is_notify_mail?(c(),l("div",qt)):(c(),l("div",Ft,Ot))])]),_:2},1032,["to"]),e("div",Jt,[e("button",{onClick:ue(x=>q(t.id),["stop"]),class:"button secondary-button text-sm"}," get Template ",8,Lt)])]))),128))])])):f("",!0)]),o(b).length===0?(c(),l("div",Qt,Kt)):f("",!0)])):f("",!0)])])}}});export{Yt as default};
